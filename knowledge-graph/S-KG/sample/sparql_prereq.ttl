PREFIX ex: <http://example.org/>
PREFIX schema: <http://schema.org/>
PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>

# Get all prereqs (direct + indirect) for a target course, along with their direct parents
SELECT DISTINCT ?prereq ?directParent
WHERE {
    VALUES ?target { ex:INFO258 }

    # Reachable prereqs (direct + indirect)
    ?target (ex:hasPrerequisite)+ ?prereq .

    # Get who that prereq depends on
    OPTIONAL {
        ?prereq (ex:hasPrerequisite) ?directParent .
    }
}